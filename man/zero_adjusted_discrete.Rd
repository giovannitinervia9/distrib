% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zero_adjusted.R
\name{zero_adjusted_discrete}
\alias{zero_adjusted_discrete}
\title{Zero-Adjusted Distribution Constructor (Discrete)}
\usage{
zero_adjusted_discrete(distrib, link_za = logit_link())
}
\arguments{
\item{distrib}{An object of class \code{"distrib"}. It must satisfy two conditions:
\enumerate{
\item \code{type == "discrete"} (e.g., Poisson, Negative Binomial).
\item The support must include 0 (i.e., \code{bounds[1] <= 0}).
}}

\item{link_za}{A link function object for the zero probability parameter \eqn{\pi}.
Defaults to \code{\link[linkfunctions]{logit_link}}.}
}
\value{
A new object of class \code{"distrib"} representing the Zero-Adjusted distribution.
}
\description{
Creates a Zero-Adjusted (Hurdle) version of an existing \strong{discrete} distribution object.
Unlike a Zero-Inflated distribution (which \emph{adds} probability mass to zero via a mixture),
a Zero-Adjusted distribution \emph{replaces} the probability mass at zero.
}
\details{
\strong{1. Definition and PDF:}
A Zero-Adjusted (Hurdle) distribution defines a process where the response \eqn{Y} is 0 with probability \eqn{\pi},
and follows a \strong{zero-truncated} distribution \eqn{f_{tr}(y)} with probability \eqn{1-\pi}.

Let \eqn{f(y; \theta)} be the PMF of the original distribution. The truncated PMF is:
\deqn{f_{tr}(y; \theta) = \dfrac{f(y; \theta)}{1 - f(0; \theta)} \quad \text{for } y > 0}

The resulting Zero-Adjusted PMF is:
\deqn{
P(Y=y; \theta, \pi) =
\begin{cases}
\pi & \text{if } y = 0 \\
(1 - \pi) \dfrac{f(y; \theta)}{1 - f(0; \theta)} & \text{if } y > 0
\end{cases}
}

\strong{2. Cumulative Distribution Function (CDF):}
\deqn{
F_{ZA}(q) =
\begin{cases}
\pi + (1 - \pi) \dfrac{F(q; \theta) - f(0; \theta)}{1 - f(0; \theta)} & \text{if } q \ge 0 \\
0 & \text{if } q < 0
\end{cases}
}

\strong{3. Quantile Function:}
Inversion involves solving for the truncated distribution when \eqn{p > \pi}.
\deqn{
Q_{ZA}(p) =
\begin{cases}
0 & \text{if } p \le \pi \\
Q\left( u(1-f(0)) + f(0) ; \theta \right) & \text{if } p > \pi
\end{cases}
}
where \eqn{u = \dfrac{p - \pi}{1 - \pi}}.

\strong{4. Moments:}
The moments are derived from the moments of the zero-truncated distribution.
Since \eqn{0^k = 0} for \eqn{k \ge 1}, the zero mass contributes nothing to raw moments.
\deqn{\mathbb{E}_{ZA}[Y^k] = (1 - \pi) \mathbb{E}_{tr}[Y^k] = (1 - \pi) \dfrac{\mathbb{E}_{orig}[Y^k]}{1 - f(0; \theta)}}
Note: The expectation \eqn{\mathbb{E}_{orig}} in the numerator technically sums from \eqn{y=0}, but since \eqn{0^k=0}, it equals the sum from \eqn{y=1}.

\strong{5. Log-Likelihood and Gradient:}
The log-likelihood is separable into a binomial part for zero/non-zero, and a truncated part:
\deqn{\ell = \mathbb{I}(y=0)\log(\pi) + \mathbb{I}(y>0) \left[ \log(1-\pi) + \log f(y; \theta) - \log(1 - f(0; \theta)) \right]}

The score vector \eqn{\nabla \ell} components are:
\itemize{
\item \strong{For \eqn{\pi} (za):}
\deqn{\dfrac{\partial \ell}{\partial \pi} = \mathbb{I}(y=0)\dfrac{1}{\pi} - \mathbb{I}(y>0)\dfrac{1}{1-\pi}}
\item \strong{For \eqn{\theta} (original params):}
For \eqn{y > 0}, a correction term arises from the normalization factor:
\deqn{\dfrac{\partial \ell}{\partial \theta} = \nabla_\theta \log f(y; \theta) + \dfrac{f'(0; \theta)}{1 - f(0; \theta)}}
For \eqn{y = 0}, the derivative w.r.t \eqn{\theta} is 0.
}

\strong{6. Hessian Matrix:}
Due to the separation of the likelihood, the parameters \eqn{\pi} and \eqn{\theta} are orthogonal (mixed derivatives are zero).
\itemize{
\item \strong{Block \eqn{\theta\theta} (Correction):}
The truncation introduces a correction term to the Hessian for \eqn{y > 0}:
\deqn{H_{corr} = \dfrac{(1-f(0))f''(0) + (f'(0))^2}{(1-f(0))^2}}
The observed Hessian for \eqn{y>0} is \eqn{H_{orig}(y) + H_{corr}}.
}
}
