% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lognormal_distrib.R
\name{lognormal_distrib}
\alias{lognormal_distrib}
\title{Lognormal \code{distrib} Object (Log-Scale Parameterization)}
\usage{
lognormal_distrib(link_mu = identity_link(), link_sigma2 = log_link())
}
\arguments{
\item{link_mu}{A link function object for the log-mean parameter \eqn{\mu}.
Defaults to \code{\link[linkfunctions]{identity_link}}.}

\item{link_sigma2}{A link function object for the log-variance parameter \eqn{\sigma^2}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}
}
\value{
A list of class \code{"distrib"} containing the components for the Lognormal distribution.
}
\description{
Creates a distribution object for the Lognormal distribution parameterized by the
mean (\eqn{\mu}) and the variance (\eqn{\sigma^2}) of the log-transformed variable.
}
\details{
The Lognormal distribution has the following probability density function:
\deqn{f(y; \mu, \sigma^2) = \dfrac{1}{y\sqrt{2\pi\sigma^2}} \exp\left\{-\dfrac{(\log y - \mu)^2}{2\sigma^2}\right\}}
for \eqn{y > 0}.

\strong{Moments:}
\itemize{
\item Expected value: \deqn{\mathbb{E}(y) = \exp\left(\mu + \dfrac{\sigma^2}{2}\right)}
\item Variance: \deqn{\mathbb{V}(y) = \left(\exp(\sigma^2) - 1\right)\exp(2\mu + \sigma^2)}
\item Skewness: \deqn{\gamma_1 = \left(\exp(\sigma^2) + 2\right)\sqrt{\exp(\sigma^2) - 1}}
\item Excess Kurtosis: \deqn{\gamma_2 = \exp(4\sigma^2) + 2\exp(3\sigma^2) + 3\exp(2\sigma^2) - 6}
}

\strong{Parameter Domains:}
\itemize{
\item \eqn{\mu \in (-\infty, +\infty)}
\item \eqn{\sigma^2 \in (0, +\infty)}
}

\strong{Explicit Formulas:}

\emph{Gradient:}

The derivatives of the log-pdf \eqn{\ell} are:
\deqn{\dfrac{\partial \ell}{\partial \mu} = \dfrac{\log(y) - \mu}{\sigma^2}}
\deqn{\dfrac{\partial \ell}{\partial \sigma^2} = \dfrac{(\log(y) - \mu)^2 - \sigma^2}{2(\sigma^2)^2}}

\emph{Expected Hessian:}

When \code{expected = TRUE}, the expected second derivatives of the log-pdf are:
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \mu^2}\right] = -\dfrac{1}{\sigma^2}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial (\sigma^2)^2}\right] = -\dfrac{1}{2(\sigma^2)^2}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \mu \partial \sigma^2}\right] = 0}

\emph{Observed Hessian:}

When \code{expected = FALSE}, the full analytical second derivatives depend on observed \eqn{y}.
\deqn{\dfrac{\partial^2 \ell}{\partial \mu^2} = -\dfrac{1}{\sigma^2}}
\deqn{\dfrac{\partial^2 \ell}{\partial (\sigma^2)^2} = -\dfrac{(\log(y) - \mu)^2}{(\sigma^2)^3} + \dfrac{1}{2(\sigma^2)^2}}
\deqn{\dfrac{\partial^2 \ell}{\partial \mu \partial \sigma^2} = -\dfrac{\log(y) - \mu}{(\sigma^2)^2}}

\emph{Derivatives with respect to \eqn{y}:}
\deqn{\dfrac{\partial \ell}{\partial y} = -\dfrac{1}{y} \left( 1 + \dfrac{\log y - \mu}{\sigma^2} \right)}
\deqn{\dfrac{\partial^2 \ell}{\partial y^2} = \dfrac{\log y - \mu}{\sigma^2 y^2}}
}
