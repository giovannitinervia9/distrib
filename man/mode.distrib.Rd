% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/numerical_functions.R
\name{mode.distrib}
\alias{mode.distrib}
\title{Numerical Mode Finding for \code{distrib} Objects}
\usage{
mode.distrib(x, theta, maxit = 10000, tol = 1e-10)
}
\arguments{
\item{x}{An object of class \code{"distrib"} containing the distribution definition
(kernel, bounds, type, etc.).}

\item{theta}{A named list of parameters for the distribution. Vectors are supported for batch calculation;
the function automatically expands and transposes parameters to handle multiple combinations.}

\item{maxit}{Integer. The maximum number of iterations allowed for the "hunting" phase
(Exponential Search) to bracket the peak. Defaults to 10000.}

\item{tol}{Numeric. The convergence tolerance for the refinement phase (used only for
continuous distributions). Defaults to \code{1e-10}.}
}
\value{
A numeric vector containing the calculated mode(s). The length corresponds to the number of
parameter sets provided in \code{theta}.
}
\description{
This function employs a two-stage numerical optimization strategy to find the global maximum
of the distribution's kernel. It automatically detects the distribution type (continuous or discrete)
and applies the appropriate algorithm:
\itemize{
\item \strong{Continuous:} Exponential Search for bracketing followed by Brent's Method.
\item \strong{Discrete:} Exponential Search for bracketing followed by Integer Binary Search.
}
}
\details{
Calculates the mode (the value \eqn{y} that maximizes the probability density or mass function)
for a given distribution object. The function is generic, robust, and does not require
analytical derivatives or prior knowledge of the distribution's moments (e.g., mean).

\strong{Algorithm Strategy:}
Since the distribution shape is treated as a "black box" (unimodal but potentially skewed or heavy-tailed),
standard gradient methods are avoided in favor of direct search methods that are robust to flat regions
and numerical noise.

\strong{Continuous Distributions:}
\enumerate{
\item \emph{Initialization:} Determines a safe starting point based on bounds.
\item \emph{Gradient Check:} Probes the local density to determine the uphill direction.
\item \emph{Exponential Search (The Hunt):} Steps away from the start point with exponentially increasing
step sizes (\eqn{1, 2, 4, \dots}) until the density begins to drop. This guarantees bracketing the mode
in \eqn{O(\log N)} steps, where \eqn{N} is the distance from the start.
\item \emph{Refinement (The Zoom):} Uses Brent's Method (via \code{\link[stats]{optimize}}) within the
found bracket to pinpoint the mode with precision \code{tol}.
}

\strong{Discrete Distributions:}
\enumerate{
\item \emph{Bracketing:} Similar to the continuous case, uses Exponential Search to find an integer interval
containing the peak.
\item \emph{Integer Binary Search:} Performs a binary search on the discrete domain. This reduces the search
space logarithmically.
\item \emph{Tie-Breaking:} In cases of bimodality (e.g., Poisson with integer \eqn{\lambda} where \eqn{P(k) = P(k-1)}),
the algorithm adopts a "Greedy Right" approach, returning the larger integer (consistent with \code{floor} behavior
for standard parameters).
}

\strong{Complexity:}
For both cases, if the mode is located at distance \eqn{N} from the origin (or lower bound), the time complexity is
\eqn{O(\log N)} in terms of kernel evaluations. This makes the function extremely efficient even for
distributions centered far from the origin (e.g., \eqn{\mu = 10^6}).
}
