% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/transformations.R
\name{transformation}
\alias{transformation}
\title{Apply a Variable Transformation to a \code{distrib} Object}
\usage{
transformation(distrib, transformer)
}
\arguments{
\item{distrib}{An object of class \code{"distrib"}. Must be a continuous distribution.}

\item{transformer}{An object of class \code{"transformer"} containing the transformation logic
(forward, inverse, Jacobian, etc.), created by functions like
\code{\link{log_transform}}, \code{\link{affine_transform}}, etc.}
}
\value{
A new \code{"distrib"} object representing the transformed variable.
}
\description{
Creates a new distribution object by applying a bijective transformation \eqn{Y = g(X)}
to an existing continuous \code{"distrib"} object.
}
\details{
\strong{Mathematical Formulation:}
This function implements the Change of Variable technique. If \eqn{X \sim f_X(x)} and \eqn{Y = g(X)},
then the density of \eqn{Y} is given by:
\deqn{f_Y(y) = f_X(g^{-1}(y)) \cdot \left| \dfrac{d}{dy} g^{-1}(y) \right|}
where \eqn{J = \dfrac{d}{dy} g^{-1}(y)} is the Jacobian of the inverse transformation.

\strong{Components Adjusted:}
The returned \code{"distrib"} object is modified as follows:
\itemize{
\item \strong{PDF:} Computed using the formula above.
\item \strong{CDF:} \eqn{F_Y(y) = F_X(g^{-1}(y))}. If the transformation is decreasing, \eqn{F_Y(y) = 1 - F_X(g^{-1}(y))}.
\item \strong{Quantile Function:} \eqn{Q_Y(p) = g(Q_X(p))}. If decreasing, \eqn{Q_Y(p) = g(Q_X(1-p))}.
\item \strong{Support:} The bounds are transformed via \eqn{g(\text{bounds})}.
\item \strong{Moments:} Analytical moments (mean, variance, skewness, kurtosis) are replaced by numerical integration methods
(\code{\link{moment}}) since closed-form solutions are generally lost after transformation.
\item \strong{RNG:} Generates \eqn{x \sim X} and returns \eqn{g(x)}.
\item \strong{Mode:} Computed numerically via \code{\link{mode.distrib}}.
}

\strong{Derivatives of the Log-Likelihood:}
When a distribution is transformed, the log-likelihood for an observation \eqn{y} is:
\deqn{\ell(\theta; y) = \log f_X(g^{-1}(y); \theta) + \log |J(y)|}
where \eqn{J(y)} is the Jacobian of the inverse transformation. Since the transformation \eqn{g}
does not depend on the parameters \eqn{\theta}, the Jacobian term \eqn{\log |J(y)|} is a constant
with respect to \eqn{\theta}. Consequently:
\itemize{
\item \strong{Gradient (Score):} The gradient of the transformed distribution is identical to the
gradient of the original distribution evaluated at the inverse-transformed point:
\deqn{\nabla_\theta \ell(\theta; y) = \nabla_\theta \log f_X(x; \theta) \mid_{x=g^{-1}(y)}}
\item \strong{Hessian (Observed):} The observed Hessian follows the same logic:
\deqn{\nabla^2_\theta \ell(\theta; y) = \nabla^2_\theta \log f_X(x; \theta) \mid_{x=g^{-1}(y)}}
\item \strong{Expected Hessian (Fisher Information):} Calculated via Monte Carlo integration
(\code{\link{mc_expected_hessian}}) using the identity
\eqn{\mathbb{E}[\nabla^2 \ell] = -\mathbb{E}[\nabla \ell (\theta)(\nabla \ell (\theta))^\top]}.
}

\strong{Numerical Stability:}
The function includes safeguards for calculating the PDF in the tails:
\itemize{
\item Calculations are performed in log-space to avoid underflow.
\item Infinite log-densities (singularities) are clamped to \code{.Machine$double.xmax} to prevent \code{Inf - Inf} issues
during numerical integration.
}
}
\seealso{
\code{\link{log_transform}}, \code{\link{affine_transform}}
}
