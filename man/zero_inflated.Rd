% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zero_inflated.R
\name{zero_inflated}
\alias{zero_inflated}
\title{Zero-Inflated Distribution Constructor (Discrete)}
\usage{
zero_inflated(distrib, link_zi = logit_link())
}
\arguments{
\item{distrib}{An object of class \code{"distrib"}. It must satisfy two conditions:
\enumerate{
\item \code{type == "discrete"} (e.g., Poisson, Negative Binomial, Binomial).
\item The support must include 0 (i.e., \code{bounds[1] <= 0}).
}}

\item{link_zi}{A link function object for the zero-inflation probability parameter \eqn{\zeta}.
Defaults to \code{\link[linkfunctions]{logit_link}}.}
}
\value{
A new object of class \code{"distrib"} representing the Zero-Inflated distribution.
}
\description{
Creates a Zero-Inflated (ZI) version of an existing \strong{discrete} distribution object.
A Zero-Inflated distribution is a mixture of a degenerate distribution at zero (point mass)
and a standard count distribution.
}
\details{
\strong{1. Definition and PDF:}
Let \eqn{f(y; \theta)} be the probability mass function (PMF) of the original discrete distribution
with parameters \eqn{\theta}.
Let \eqn{\zeta \in [0, 1]} be the zero-inflation probability (structural zeros).

The PMF of the Zero-Inflated variable \eqn{Y} is given by:
\deqn{
P(Y=y; \theta, \zeta) =
\begin{cases}
\zeta + (1 - \zeta)f(0; \theta) & \text{if } y = 0 \\
(1 - \zeta)f(y; \theta) & \text{if } y > 0
\end{cases}
}

\strong{2. Cumulative Distribution Function (CDF):}
The CDF \eqn{F_{ZI}(q)} is derived from the original CDF \eqn{F(q; \theta)}:
\deqn{F_{ZI}(q) = (1 - \zeta)F(q; \theta) + \mathbb{I}(q \ge 0)\zeta}

\strong{3. Quantile Function:}
The quantile function \eqn{Q_{ZI}(p)} is found by inverting the CDF.
Let \eqn{P(Y=0) = \zeta + (1-\zeta)f(0; \theta)} be the total probability at zero.
\deqn{
Q_{ZI}(p) =
\begin{cases}
0 & \text{if } p \le \zeta + (1-\zeta)F(0; \theta) \\
Q\left(\dfrac{p - \zeta}{1 - \zeta}; \theta\right) & \text{if } p > \zeta + (1-\zeta)F(0; \theta)
\end{cases}
}
where \eqn{Q(\cdot; \theta)} is the quantile function of the original distribution.

\strong{4. Moments:}
The moments are derived from the raw moments of the original distribution.
Let \eqn{\mu'_k = \mathbb{E}_{orig}[Y^k]} be the \eqn{k}-th raw moment of the count component.
\itemize{
\item \strong{Raw Moments:} \eqn{\mathbb{E}_{ZI}[Y^k] = (1 - \zeta)\mu'_k}
\item \strong{Mean:} \eqn{\mathbb{E}[Y] = (1 - \zeta)\mathbb{E}_{orig}[Y]}
\item \strong{Variance:} \eqn{\mathbb{V}(Y) = (1 - \zeta)\mathbb{E}_{orig}[Y^2] - [(1 - \zeta)\mathbb{E}_{orig}[Y]]^2}
}
Skewness and Kurtosis are computed numerically from the standardized central moments derived from these raw moments.

\strong{5. Log-Likelihood and Gradient (Score):}
Let \eqn{L_0 = \zeta + (1-\zeta)f(0; \theta)} be the likelihood contribution for an observation \eqn{y=0}.
The log-likelihood is:
\deqn{\ell = \mathbb{I}(y=0)\log(L_0) + \mathbb{I}(y>0)[\log(1-\zeta) + \log f(y; \theta)]}

The score vector \eqn{\nabla \ell} has components:
\itemize{
\item \strong{For the inflation parameter \eqn{\zeta}:}
\deqn{\dfrac{\partial \ell}{\partial \zeta} = \mathbb{I}(y=0)\dfrac{1 - f(0; \theta)}{L_0} - \mathbb{I}(y>0)\dfrac{1}{1 - \zeta}}
\item \strong{For original parameters \eqn{\theta}:}
\deqn{\dfrac{\partial \ell}{\partial \theta} = \mathbb{I}(y=0)\dfrac{1 - \zeta}{L_0}\dfrac{\partial f(0; \theta)}{\partial \theta} + \mathbb{I}(y>0)\dfrac{\partial \log f(y; \theta)}{\partial \theta}}
}

\strong{6. Observed Hessian Matrix:}
\itemize{
\item \strong{Block \eqn{\zeta\zeta} (Observed):}
\deqn{\dfrac{\partial^2 \ell}{\partial \zeta^2} = -\mathbb{I}(y=0)\left[\dfrac{1 - f(0; \theta)}{L_0}\right]^2 - \mathbb{I}(y>0)\dfrac{1}{(1 - \zeta)^2}}
\item \strong{Block \eqn{\zeta\theta} (Mixed Observed):}
\deqn{\dfrac{\partial^2 \ell}{\partial \zeta \partial \theta} = -\mathbb{I}(y=0)\dfrac{f(0; \theta)}{L_0^2}\dfrac{\partial f(0; \theta)}{\partial \theta}}
(Note: This term is 0 for \eqn{y > 0}).
\item \strong{Block \eqn{\theta\theta} (Observed):}
\deqn{
     \dfrac{\partial^2 \ell}{\partial \theta \partial \theta^T} =
     \begin{cases}
     \dfrac{1-\zeta}{L_0}\nabla^2 f(0) - \left(\dfrac{1-\zeta}{L_0}\right)^2 \nabla f(0) \nabla f(0)^T & \text{if } y = 0 \\
     \nabla^2 \log f(y; \theta) & \text{if } y > 0
     \end{cases}
     }
}

\strong{7. Expected Hessian (Fisher Information):}
The expected Hessian \eqn{\mathbb{E}[\mathcal{H}]} is calculated as the negative sum of score outer products across the full support.
\itemize{
\item \strong{Block \eqn{\zeta\zeta}:}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \zeta^2}\right] = -\left[ \dfrac{(1-f(0))^2}{L_0} + \dfrac{1-f(0)}{1-\zeta} \right]}
\item \strong{Block \eqn{\zeta\theta}:}
The cross-terms simplify analytically to:
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \zeta \partial \theta}\right] = -\dfrac{1}{L_0} \nabla_\theta f(0; \theta)}
\item \strong{Block \eqn{\theta\theta}:}
Computed by decomposing the expectation over \eqn{y=0} and \eqn{y>0}:
\deqn{\mathbb{E}\left[\mathcal{H}_{\theta\theta}\right] = L_0 \mathcal{H}_{\theta\theta}^{\text{obs}}(0) + (1-\zeta) \left( \mathbb{E}_{orig}[\mathcal{H}_{orig}] - f(0)\mathcal{H}_{orig}^{\text{obs}}(0) \right)}
where \eqn{\mathcal{H}_{orig}^{\text{obs}}(0)} is the observed Hessian of the count density evaluated at 0.
}
}
