% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/numerical_functions.R
\name{rng_continuous_grou}
\alias{rng_continuous_grou}
\title{Generalized Ratio-of-Uniforms (GRoU) Random Number Generator}
\usage{
rng_continuous_grou(n, x, theta, r = 2)
}
\arguments{
\item{n}{Integer. The number of random variates to generate.}

\item{x}{An object of class \code{"distrib"}.
Must contain the following components: \code{kernel}, \code{mode}, \code{variance}, and \code{bounds}.}

\item{theta}{A named list of parameters for the distribution.}

\item{r}{Numeric. The tuning parameter for the transformation power. Defaults to 2.
Common choices are:
\itemize{
\item \code{r = 1}: Standard Ratio-of-Uniforms.
\item \code{r = 2}: Often more efficient for heavy-tailed distributions.
}}
}
\value{
A numeric vector of length \code{n} containing the generated random variates.
}
\description{
Generates random variates from a continuous distribution object using the Generalized
Ratio-of-Uniforms (GRoU) method.

This function is a generic sampler that does not require the inverse CDF. Instead, it relies on
the kernel of the probability density function and the mode of the distribution. It automatically
constructs the bounding rectangle for the acceptance-rejection method.
}
\details{
\strong{The GRoU Method:}

The Generalized Ratio-of-Uniforms method generates random variables \eqn{Y} with density proportional
to a kernel \eqn{K(y)} by simulating a point \eqn{(U, V)} uniformly over the region:
\deqn{A_r = \left\{ (u, v) : 0 < u \leq \left[ K\left( \frac{v}{u^r} \right) \right]^{\frac{1}{r+1}} \right\}}

If \eqn{(U, V)} is uniformly distributed over \eqn{A_r}, then \eqn{Y = V / U^r} has the desired distribution.

\strong{Algorithm Steps:}

\enumerate{
\item \strong{Bounding Rectangle Construction:} The algorithm first determines the bounding box
\eqn{[0, u_{\max}] \times [v_{\min}, v_{\max}]} enclosing \eqn{A_r}.
\itemize{
\item \eqn{u_{\max} = \sup_y K(y)^{\frac{1}{r+1}}}. Calculated at the distribution's mode.
\item \eqn{v_{\min} = \inf_y h(y)} and \eqn{v_{\max} = \sup_y h(y)}, where the auxiliary function is
\eqn{h(y) = y \cdot K(y)^{\frac{r}{r+1}}}.
}
\item \strong{Heuristic Optimization:} To find \eqn{v_{\min}} and \eqn{v_{\max}}, the function performs
a dynamic search starting from the mode and expanding outwards using the standard deviation (derived from
\code{x$variance}) as a step size, until the function value decreases sufficiently. This defines the search
interval for the \code{\link[stats]{optimize}} function.
\item \strong{Sampling Loop:}
\itemize{
\item Generate \eqn{U \sim \text{Unif}(0, u_{\max})} and \eqn{V \sim \text{Unif}(v_{\min}, v_{\max})}.
\item Compute candidate \eqn{Y = V / U^r}.
\item Accept \eqn{Y} if \eqn{(r+1) \log(U) \leq \log K(Y)}.
}
}

\strong{Robustness:}
The function includes safeguards against infinite loops (max 10 consecutive failures in batch sampling)
and checks for NaN/NA values during the initialization of bounds.
}
