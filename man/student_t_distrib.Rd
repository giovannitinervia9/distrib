% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/student_t_distrib.r
\name{student_t_distrib}
\alias{student_t_distrib}
\title{Student's t \code{distrib} Object (Location-Scale Parameterization)}
\usage{
student_t_distrib(
  link_mu = identity_link(),
  link_sigma = log_link(),
  link_nu = log_link()
)
}
\arguments{
\item{link_mu}{A link function object for the location parameter \eqn{\mu}.
Defaults to \code{\link[linkfunctions]{identity_link}}.}

\item{link_sigma}{A link function object for the scale parameter \eqn{\sigma}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}

\item{link_nu}{A link function object for the degrees of freedom parameter \eqn{\nu}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}
}
\value{
A list of class \code{"distrib"} containing the components for the Student's t distribution.
}
\description{
Creates a distribution object for the Student's t distribution parameterized by location (\eqn{\mu}), scale (\eqn{\sigma}), and degrees of freedom (\eqn{\nu}).
}
\details{
The probability density function is given by:
\deqn{f(y; \mu, \sigma, \nu) = \dfrac{\Gamma\left(\dfrac{\nu+1}{2}\right)}{\sigma\sqrt{\nu\pi}\,\Gamma\left(\dfrac{\nu}{2}\right)} \left(1 + \dfrac{(y-\mu)^2}{\nu\sigma^2}\right)^{-\dfrac{\nu+1}{2}}}
for \eqn{y \in (-\infty, +\infty)}.

\strong{Moments:}
\itemize{
\item Expected value: \deqn{\mathbb{E}(y) = \mu \quad (\text{if } \nu > 1)}
\item Variance: \deqn{\mathbb{V}(y) = \sigma^2 \dfrac{\nu}{\nu-2} \quad (\text{if } \nu > 2)}
\item Skewness: \deqn{\gamma_1 = 0 \quad (\text{if } \nu > 3)}
\item Excess Kurtosis: \deqn{\gamma_2 = \dfrac{6}{\nu-4} \quad (\text{if } \nu > 4)}
}

\strong{Parameter Domains:}
\itemize{
\item \eqn{\mu \in (-\infty, +\infty)}
\item \eqn{\sigma \in (0, +\infty)}
\item \eqn{\nu \in (0, +\infty)}
}

\strong{Explicit Derivatives:}

Let \eqn{\psi(z)} be the digamma function and \eqn{\psi_1(z)} be the trigamma function.

\emph{Gradient (First Derivatives):}

\deqn{\dfrac{\partial \ell}{\partial \mu} = \dfrac{(\nu+1)(y-\mu)}{\nu\sigma^2 + (y-\mu)^2}}

\deqn{\dfrac{\partial \ell}{\partial \sigma} = \dfrac{\nu\left[(y-\mu)^2 - \sigma^2\right]}{\sigma\left[\nu\sigma^2 + (y-\mu)^2\right]}}

\deqn{\dfrac{\partial \ell}{\partial \nu} = \dfrac{1}{2}\left[ -\dfrac{1}{\nu} - \psi\left(\dfrac{\nu}{2}\right) + \psi\left(\dfrac{\nu+1}{2}\right) + \dfrac{(\nu+1)(y-\mu)^2}{\nu\left[\nu\sigma^2 + (y-\mu)^2\right]} - \log\left(1 + \dfrac{(y-\mu)^2}{\nu\sigma^2}\right) \right]}

\emph{Expected Hessian:}

When \code{expected = TRUE}, the formulas depend only on the parameters (not on \eqn{y}).
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \mu^2}\right] = -\dfrac{\nu+1}{\sigma^2(\nu+3)}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \sigma^2}\right] = -\dfrac{2\nu}{\sigma^2(\nu+3)}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \nu^2}\right] = \dfrac{1}{4}\left[\psi_1\left(\dfrac{\nu+1}{2}\right) - \psi_1\left(\dfrac{\nu}{2}\right)\right] + \dfrac{\nu+5}{2\nu(\nu+1)(\nu+3)}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \sigma \partial \nu}\right] = \dfrac{2}{\sigma(\nu+1)(\nu+3)}}

The parameter \eqn{\mu} is orthogonal to \eqn{\sigma} and \eqn{\nu} (mixed expected derivatives are 0).

\emph{Observed Hessian (Second Derivatives):}

When \code{expected = FALSE}, the analytical second derivatives depend on observed \eqn{y}.

\deqn{\dfrac{\partial^2 \ell}{\partial \mu^2} = \dfrac{(\nu+1)\left[(y-\mu)^2 - \nu\sigma^2\right]}{\left[\nu\sigma^2 + (y-\mu)^2\right]^2}}

\deqn{\dfrac{\partial^2 \ell}{\partial \sigma^2} = \dfrac{\nu\left[\nu\sigma^4 - (3\nu+1)\sigma^2(y-\mu)^2 - (y-\mu)^4\right]}{\sigma^2\left[\nu\sigma^2 + (y-\mu)^2\right]^2}}

\deqn{\dfrac{\partial^2 \ell}{\partial \nu^2} = \dfrac{1}{4}\left[ -\psi_1\left(\dfrac{\nu}{2}\right) + \psi_1\left(\dfrac{\nu+1}{2}\right) + \dfrac{2\left(\nu\sigma^4 + (y-\mu)^4\right)}{\nu\left[\nu\sigma^2 + (y-\mu)^2\right]^2} \right]}

\deqn{\dfrac{\partial^2 \ell}{\partial \mu \partial \sigma} = -\dfrac{2\nu(\nu+1)\sigma(y-\mu)}{\left[\nu\sigma^2 + (y-\mu)^2\right]^2}}

\deqn{\dfrac{\partial^2 \ell}{\partial \mu \partial \nu} = \dfrac{(y-\mu)\left[(y-\mu)^2 - \sigma^2\right]}{\left[\nu\sigma^2 + (y-\mu)^2\right]^2}}

\deqn{\dfrac{\partial^2 \ell}{\partial \sigma \partial \nu} = \dfrac{(y-\mu)^2\left[(y-\mu)^2 - \sigma^2\right]}{\sigma\left[\nu\sigma^2 + (y-\mu)^2\right]^2}}

\emph{Derivatives with respect to y:}
\deqn{\dfrac{\partial \ell}{\partial y} = -\dfrac{(\nu+1)(y-\mu)}{\nu\sigma^2 + (y-\mu)^2}}
\deqn{\dfrac{\partial^2 \ell}{\partial y^2} = \dfrac{(\nu+1)\left[(y-\mu)^2 - \nu\sigma^2\right]}{\left[\nu\sigma^2 + (y-\mu)^2\right]^2}}
}
