% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/invgauss_distrib.R
\name{invgauss_distrib}
\alias{invgauss_distrib}
\title{Inverse-Gaussian \code{distrib} Object (Mean-Dispersion Parameterization)}
\usage{
invgauss_distrib(link_mu = log_link(), link_phi = log_link())
}
\arguments{
\item{link_mu}{A link function object for the mean parameter \eqn{\mu}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}

\item{link_phi}{A link function object for the dispersion parameter \eqn{\phi}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}
}
\value{
A list of class \code{"distrib"} containing the components for the Inverse-Gaussian distribution.

\emph{Derivatives with respect to \eqn{y}:}
\deqn{\dfrac{\partial \ell}{\partial y} = -\dfrac{3}{2y} - \dfrac{y^2 - \mu^2}{2\phi\mu^2 y^2}}
\deqn{\dfrac{\partial^2 \ell}{\partial y^2} = \dfrac{3}{2y^2} - \dfrac{1}{\phi y^3}}
}
\description{
Creates a distribution object for the Inverse-Gaussian distribution parameterized by mean (\eqn{\mu}) and dispersion (\eqn{\phi}).
}
\details{
The Inverse-Gaussian distribution has the following density function:
\deqn{f(y; \mu, \phi) = \sqrt{\dfrac{1}{2\pi\phi y^3}} \exp\left\{-\dfrac{(y-\mu)^2}{2\phi\mu^2 y}\right\}}
for \eqn{y > 0}.

The probability density, cumulative distribution, quantile, and random generation functions
are provided by the \code{\link[statmod]{dinvgauss}}, \code{\link[statmod]{pinvgauss}},
\code{\link[statmod]{qinvgauss}}, and \code{\link[statmod]{rinvgauss}} functions
from the \pkg{statmod} package.

\strong{Moments:}
\itemize{
\item Expected value: \deqn{\mathbb{E}(y) = \mu}
\item Variance: \deqn{\mathbb{V}(y) = \phi \mu^3}
\item Skewness: \deqn{\gamma_1 = 3\sqrt{\phi \mu}}
\item Excess Kurtosis: \deqn{\gamma_2 = 15 \phi \mu}
}

\strong{Parameter Domains:}
\itemize{
\item \eqn{\mu \in (0, +\infty)}
\item \eqn{\phi \in (0, +\infty)}
}

\strong{Explicit Formulas:}

\emph{Gradient:}

The derivatives of the log-pdf \eqn{\ell} with respect to the parameters are:
\deqn{\dfrac{\partial \ell}{\partial \mu} = \dfrac{y - \mu}{\phi\mu^3}}
\deqn{\dfrac{\partial \ell}{\partial \phi} = \dfrac{(y - \mu)^2 - y\mu^2\phi}{2y\phi^2\mu^2}}

\emph{Expected Hessian:}

When \code{expected = TRUE}, the expected second derivatives of the log-pdf are:
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \mu^2}\right] = -\dfrac{1}{\phi\mu^3}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \phi^2}\right] = -\dfrac{1}{2\phi^2}}
\deqn{\mathbb{E}\left[\dfrac{\partial^2 \ell}{\partial \mu \partial \phi}\right] = 0}

\emph{Observed Hessian:}

When \code{expected = FALSE}, the second derivatives of the log-pdf depend on observed \eqn{y}:
\deqn{\dfrac{\partial^2 \ell}{\partial \mu^2} = -\dfrac{3y - 2\mu}{\phi\mu^4}}
\deqn{\dfrac{\partial^2 \ell}{\partial \phi^2} = \dfrac{\phi - 2(y-\mu)^2/(\mu^2 y)}{2\phi^3}}
\deqn{\dfrac{\partial^2 \ell}{\partial \mu \partial \phi} = -\dfrac{y - \mu}{\phi^2\mu^3}}
\strong{Note:} The observed Hessian with respect to \eqn{\phi} is not guaranteed to be negative for all
observed values of \eqn{y}. Specifically, \eqn{\partial^2 \ell/\partial \phi^2 < 0} only when
\eqn{\phi < 2(y-\mu)^2/(\mu^2 y)}. This condition may be violated when observations are far from the mean
or when the dispersion parameter is large, potentially causing numerical instability in optimization
algorithms that rely on the observed Hessian (e.g., Newton-Raphson). In such cases, using the expected
Hessian (\code{expected = TRUE}) is recommended for more stable convergence.
}
\references{
Giner, G., and Smyth, G. K. (2016). statmod: Probability calculations for the inverse Gaussian distribution.
\emph{R Journal} \strong{8}(1), 339-351. \url{https://journal.r-project.org/articles/RJ-2016-024/}
}
