% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/numerical_functions.R
\name{moment}
\alias{moment}
\title{Calculate Moments of a Distribution}
\usage{
moment(distrib, theta, p = 2, central = FALSE, mu = NULL, ...)
}
\arguments{
\item{distrib}{An object of class \code{"distrib"} containing the distribution definition
(pdf, bounds, type, etc.).}

\item{theta}{A named list of parameters for the distribution. Vectors are supported for batch calculation.}

\item{p}{Numeric. The order of the moment to calculate. Defaults to 2.}

\item{central}{Logical. If \code{TRUE}, calculates the central moment (about the mean).
If \code{FALSE} (default), calculates the raw moment (about zero).}

\item{mu}{Numeric (optional). The mean value used for central moment calculations.
If \code{NULL} (default) and \code{central = TRUE}, the function attempts to retrieve
the mean from the \code{distrib} object or calculates it numerically by calling \code{moment(..., p=1)}.}

\item{...}{Additional arguments passed to the underlying numerical engine:
\itemize{
\item For continuous: passed to \code{\link[stats]{integrate}} (e.g., \code{subdivisions}, \code{rel.tol}).
\item For discrete: passed to \code{series} (e.g., \code{step}, \code{tol}, \code{maxit}).
}}
}
\value{
A numeric vector containing the calculated moments.
}
\description{
A generic function to calculate the \eqn{p}-th moment (raw or central) of a probability distribution.
It automatically handles continuous distributions via numerical integration and discrete distributions
via series summation.
}
\details{
\strong{Definitions:}
\itemize{
\item \strong{Raw Moment:} If \code{central = FALSE}, calculates \eqn{E[X^p] = \int x^p f(x) dx} (or \eqn{\sum x^p P(x)}).
\item \strong{Central Moment:} If \code{central = TRUE}, calculates \eqn{E[(X - \mu)^p] = \int (x - \mu)^p f(x) dx} (or \eqn{\sum (x - \mu)^p P(x)}),
where \eqn{\mu} is the mean of the distribution.
}

\strong{Mechanism:}
\itemize{
\item \strong{Continuous Distributions:} Uses \code{\link[stats]{integrate}}. To ensure numerical stability for
distributions with sharp peaks on infinite domains, the function
attempts to identify the \strong{mode} of the distribution. If found, the integration interval is split
at the mode (\eqn{[lb, mode] + [mode, ub]}). This "anchoring" forces the numerical integrator to
evaluate the function in the region of highest density, preventing underflow errors where the integral
would otherwise be incorrectly estimated as zero.
\item \strong{Discrete Distributions:} Uses the internal function \code{series} to sum the terms.
}

\strong{Robustness:}
The integrand is protected against non-finite values (NaN/Inf) which are coerced to 0, assuming they occur
in the negligible tails of the distribution.

\strong{Vectorization:}
The function fully supports vectorized parameters (\code{theta}). If \code{theta} contains vectors of length \eqn{n},
the function returns a vector of \eqn{n} moments. The order \code{p} can also be a vector of length \eqn{n}
(matching \code{theta}) or a scalar.
}
