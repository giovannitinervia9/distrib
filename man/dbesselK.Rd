% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/numerical_functions.R
\name{dbesselK}
\alias{dbesselK}
\title{Derivatives of the Modified Bessel Function of the Second Kind}
\usage{
dbesselK(
  x,
  nu,
  deriv = 1L,
  expon.scaled = FALSE,
  mode = c("standard", "deriv_scaled")
)
}
\arguments{
\item{x}{Numeric vector. The input argument (must be > 0).}

\item{nu}{Numeric vector. The order of the Bessel function.}

\item{deriv}{Integer. The order of the derivative to compute (must be \eqn{\ge 0}). Defaults to 1.}

\item{expon.scaled}{Logical. Controls exponential scaling.
\itemize{
\item If \code{mode = "standard"}: If \code{TRUE}, returns \eqn{e^x \cdot K^{(n)}_\nu(x)}. If \code{FALSE}, returns \eqn{K^{(n)}_\nu(x)}.
\item If \code{mode = "deriv_scaled"}: This argument is ignored because the target function is inherently scaled.
}}

\item{mode}{Character string. Determines the type of derivative to compute:
\itemize{
\item \code{"standard"} (Default): Computes the derivative of the Bessel function itself.
\item \code{"deriv_scaled"}: Computes the derivative of the scaled Bessel function.
}}
}
\value{
A numeric vector of the same length as \code{x} (or \code{nu}).
}
\description{
Calculates the n-th order derivative of the modified Bessel function of the second kind, \eqn{K_\nu(x)}.
}
\details{
The function implements two different mathematical approaches based on \code{mode}:

\strong{1. Standard Mode (\code{mode = "standard"}):} \cr
Calculates \eqn{\frac{d^n}{dx^n} K_\nu(x)}. \cr
It uses the recurrence relation:
\deqn{K^{(n)}_\nu(x) = (-1/2)^n \sum_{k=0}^{n} \binom{n}{k} K_{\nu - n + 2k}(x)}
If \code{expon.scaled = TRUE}, the result is multiplied by \eqn{e^x} to prevent underflow for large \eqn{x}.

\strong{2. Scaled Derivative Mode (\code{mode = "deriv_scaled"}):} \cr
Calculates the derivative of the product \eqn{e^x K_\nu(x)}.
\deqn{\frac{d^n}{dx^n} \left( e^x K_\nu(x) \right)}
Using the General Leibniz rule, this expands to:
\deqn{e^x \sum_{j=0}^{n} \binom{n}{j} K^{(j)}_\nu(x)}
}
\examples{
# --- Case 1: Standard derivative K'(x) ---
# Analytical derivative
dy <- dbesselK(x = 5, nu = 1, deriv = 1, mode = "standard")

# --- Case 2: Scaled derivative for large x ---
# Returns e^x * K'(x)
dy_scaled <- dbesselK(x = 1000, nu = 1, deriv = 1, expon.scaled = TRUE)

# --- Case 3: Derivative of the scaled function (numDeriv compat) ---
# We want d/dx (e^x * K(x))
library(numDeriv)
x_val <- 2

# Numerical result
f_sc <- function(x) besselK(x, 1, expon.scaled = TRUE)
num_res <- grad(f_sc, x_val)

# Analytical result using mode = "deriv_scaled"
ana_res <- dbesselK(x_val, 1, deriv = 1, mode = "deriv_scaled")

c(Numerical = num_res, Analytical = ana_res)

}
