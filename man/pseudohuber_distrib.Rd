% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pseudohuber_distrib.R
\name{pseudohuber_distrib}
\alias{pseudohuber_distrib}
\title{Pseudo-Huber \code{distrib} Object (Location-Scale Parameterization)}
\usage{
pseudohuber_distrib(
  link_mu = identity_link(),
  link_sigma = log_link(),
  link_nu = log_link()
)
}
\arguments{
\item{link_mu}{A link function object for the location parameter \eqn{\mu}.
Defaults to \code{\link[linkfunctions]{identity_link}}.}

\item{link_sigma}{A link function object for the scale parameter \eqn{\sigma}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}

\item{link_nu}{A link function object for the shape parameter \eqn{\nu}.
Defaults to \code{\link[linkfunctions]{log_link}} to ensure positivity.}
}
\value{
A list of class \code{"distrib"} containing the components for the Pseudo-Huber distribution.
}
\description{
Creates a \code{distrib} object for the Pseudo-Huber distribution, which corresponds to the probability density
defined by the Pseudo-Huber loss function kernel. It is a specific case of the Generalized Hyperbolic distribution.
}
\details{
The probability density function is proportional to the exponential of the negative Pseudo-Huber loss:
\deqn{f(y; \mu, \sigma, \nu) = \dfrac{1}{2 \sigma \sqrt{\nu} K_1(\sqrt{\nu})} \exp\left( - \sqrt{\nu + \left(\dfrac{y-\mu}{\sigma}\right)^2} \right)}

Where the normalization constant involves the modified Bessel function of the second kind \eqn{K_1}.

\strong{Moments:}
\itemize{
\item Expected value: \deqn{\mathbb{E}(y) = \mu}
\item Variance: \deqn{\mathbb{V}(y) = \sigma^2 \sqrt{\nu} \dfrac{K_2(\sqrt{\nu})}{K_1(\sqrt{\nu})}}
\item Kurtosis: Depends on ratios of \eqn{K_3, K_1} and \eqn{K_2}.
}

\strong{Parameter Domains:}
\itemize{
\item \eqn{\mu \in (-\infty, +\infty)}
\item \eqn{\sigma \in (0, +\infty)}
\item \eqn{\nu \in (0, +\infty)}
}

\strong{Explicit Derivatives:}

Let \eqn{r = y - \mu} and \eqn{D = \sqrt{\nu + (r/\sigma)^2}}.

\emph{Gradient (First Derivatives):}

\deqn{\dfrac{\partial \ell}{\partial \mu} = \dfrac{r}{\sigma^2 D}}

\deqn{\dfrac{\partial \ell}{\partial \sigma} = \dfrac{1}{\sigma} \left( \dfrac{r^2}{\sigma^2 D} - 1 \right)}

\deqn{\dfrac{\partial \ell}{\partial \nu} = -\dfrac{1}{2} \left[ \dfrac{1}{\nu} + \dfrac{1}{D} + \dfrac{K_1'(\sqrt{\nu})}{\sqrt{\nu} K_1(\sqrt{\nu})} \right]}

Where \eqn{K_1'(z)} is the derivative of the modified Bessel function of the second kind with respect to its argument.

\emph{Observed Hessian (Second Derivatives):}

The following formulas utilize the observed data (via \eqn{r} and \eqn{D}). Let \eqn{R_1 = \dfrac{K_1'(\sqrt{\nu})}{K_1(\sqrt{\nu})}} and \eqn{R_2 = \dfrac{K_1''(\sqrt{\nu})}{K_1(\sqrt{\nu})}}.

\deqn{\dfrac{\partial^2 \ell}{\partial \mu^2} = -\dfrac{\nu}{\sigma^2 D^3}}

\deqn{\dfrac{\partial^2 \ell}{\partial \sigma^2} = \dfrac{\sigma^4 - 3\sigma^2 r^2 D^{-1} + r^4 D^{-3}}{\sigma^6}}

\deqn{\dfrac{\partial^2 \ell}{\partial \nu^2} = \dfrac{1}{4D^3} + \dfrac{1}{2\nu^2} + \dfrac{1}{4}\left(\dfrac{R_1}{\nu^{3/2}} + \dfrac{R_1^2}{\nu} - \dfrac{R_2}{\nu}\right)}

\deqn{\dfrac{\partial^2 \ell}{\partial \mu \partial \sigma} = \dfrac{-2\nu\sigma^2 r - r^3}{\sigma^2(\nu\sigma^2 + r^2)^{3/2}}}

\deqn{\dfrac{\partial^2 \ell}{\partial \mu \partial \nu} = -\dfrac{r}{2\sigma^2 D^3}}

\deqn{\dfrac{\partial^2 \ell}{\partial \sigma \partial \nu} = -\dfrac{r^2}{2\sigma^3 D^3}}

\emph{Expected Hessian:}

There are no closed-form analytical formulas for the expected Hessian of the Pseudo-Huber distribution.
When \code{expected = TRUE} inside \code{pseudohuber_distrib()$hessian()}, the expected Hessian is approximated using Monte Carlo simulation
via the function \code{\link{mc_expected_hessian}}.
Note that the location parameter \eqn{\mu} is orthogonal to the scale parameter \eqn{\sigma} and the shape parameter \eqn{\nu},
since \eqn{\mathbb{E}(r) = \mathbb{E}(r^3) = 0}.
}
