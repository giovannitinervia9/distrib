% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/numerical_functions.R
\name{mc_expected_hessian}
\alias{mc_expected_hessian}
\title{Monte Carlo Approximation of the Expected Hessian}
\usage{
mc_expected_hessian(distrib, y, theta, nsim = 1000)
}
\arguments{
\item{distrib}{An object of class \code{"distrib"}.
Must contain \code{params}, \code{gradient}, and \code{rng} components.}

\item{y}{A vector or matrix of the observed response variable. Used to determine the number of
observations (\code{n}).}

\item{theta}{A list containing the parameter values.}

\item{nsim}{Integer. The number of Monte Carlo simulations to perform for each observation.
Defaults to 1000. Higher values provide better approximations but increase computation time.}
}
\value{
A named list of length \eqn{p(p+1)/2} (where \eqn{p} is the number of parameters),
containing the unique elements of the expected Hessian matrix.

The list elements are named as follows:
\itemize{
\item Diagonal elements: \code{"par_par"} (e.g., \code{"mu_mu"}, \code{"sigma_sigma"})
\item Off-diagonal elements: \code{"par1_par2"} (e.g., \code{"mu_sigma"}), stored in the order
defined by the distribution object.
}
Each element of the list is a numeric vector of length \code{NROW(y)}, representing the
expected second derivative for each observation.
}
\description{
Approximates the expected Hessian matrix (Fisher Information Matrix elements) for a given
distribution object using Monte Carlo simulation.

This function relies on the identity that, under regularity conditions, the expected Hessian
is equal to the negative of the expected outer product of the score function (gradients):
\deqn{\mathbb{E}\left[\nabla^2 \ell(\theta)\right] = -\mathbb{E}\left[\nabla \ell(\theta) (\nabla \ell(\theta))^\top\right]}
}
\details{
For each observation \eqn{k} in \code{y}, the function:
\enumerate{
\item Simulates \code{nsim} random values from the distribution using the parameters \eqn{\theta_k}.
\item Calculates the gradient (score vector) for these simulated values.
\item Computes the empirical mean of the negative cross-products of the gradients.
}

The resulting approximation is useful when the analytical expected Hessian is difficult
or impossible to derive in closed form.
}
