% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zero_adjusted.R
\name{zero_adjusted_continuous}
\alias{zero_adjusted_continuous}
\title{Zero-Adjusted Continuous Distribution Constructor}
\usage{
zero_adjusted_continuous(distrib, link_za = logit_link())
}
\arguments{
\item{distrib}{An object of class \code{"distrib"}. It must satisfy two conditions:
\enumerate{
\item \code{type == "continuous"} (e.g., Gamma, Lognormal).
\item The domain is typically \eqn{(0, \infty)} (though it technically works for any continuous dist).
}}

\item{link_za}{A link function object for the zero probability parameter \eqn{p} (denoted as \code{za}).
Defaults to \code{\link[linkfunctions]{logit_link}}.}
}
\value{
A new object of class \code{"distrib"} representing the Zero-Adjusted Continuous distribution.
}
\description{
Creates a Zero-Adjusted (ZA) version of an existing \strong{continuous} distribution object defined on \eqn{(0, \infty)}.
This model is often referred to as a "Zero-Inflated" continuous distribution (e.g., Zero-Inflated Gamma)
or "Hurdle" continuous model.

It assumes the response variable \eqn{Y} follows a mixed distribution: a point mass at 0 with probability \eqn{p},
and a continuous distribution \eqn{W} (the original object) with probability \eqn{1-p}.
}
\details{
\strong{1. Definition and PDF:}
Let \eqn{Y \sim \text{ZAW}} denote the zero-adjusted variable.
Let \eqn{f_W(y; \theta)} be the PDF of the original continuous distribution \eqn{W} (where \eqn{W} has support \eqn{y > 0}).
Let \eqn{p \in [0, 1]} be the probability of zero (\code{za}).

The PDF of \eqn{Y} is defined as (Rigby et al., Eq 9.1):
\deqn{
f_Y(y) =
\begin{cases}
p & \text{if } y = 0 \\
(1 - p) f_W(y; \theta) & \text{if } y > 0
\end{cases}
}

\strong{2. Cumulative Distribution Function (CDF):}
\deqn{
F_Y(q) =
\begin{cases}
0 & \text{if } q < 0 \\
p + (1 - p) F_W(q; \theta) & \text{if } q \ge 0
\end{cases}
}
Note that \eqn{F_Y(0) = p} (assuming \eqn{F_W(0) = 0}, which is standard for Gamma/LogNormal).

\strong{3. Quantile Function:}
\deqn{
Q_Y(u) =
\begin{cases}
0 & \text{if } u \le p \\
Q_W\left( \dfrac{u - p}{1 - p}; \theta \right) & \text{if } u > p
\end{cases}
}

\strong{4. Moments (GAMLSS Eq 9.2):}
The moments of \eqn{Y} are derived analytically from the raw and central moments of the original distribution \eqn{W}.
Let \eqn{\mu'_1 = \mathbb{E}[W]} be the mean of \eqn{W}, and \eqn{\mu_k = \mathbb{E}[(W - \mu'_1)^k]} be the \eqn{k}-th central moment of \eqn{W}.

\itemize{
\item \strong{Mean:} \eqn{\mathbb{E}[Y] = (1-p)\mu'_1}
\item \strong{Variance:} \eqn{\mathbb{V}(Y) = (1-p)\mu_2 + p(1-p)(\mu'_1)^2}
\item \strong{Skewness:}
\deqn{\mu_{3Y} = (1-p)[\mu_3 + 3p\mu_2\mu'_1 + p(2p-1)(\mu'_1)^3]}
\eqn{\gamma_{1Y} = \mu_{3Y} / \mathbb{V}(Y)^{1.5}}
\item \strong{Excess Kurtosis:}
\deqn{\mu_{4Y} = (1-p)[\mu_4 + 4p\mu_3\mu'_1 + 6p^2\mu_2(\mu'_1)^2 + p(1-3p+3p^2)(\mu'_1)^4]}
\eqn{\gamma_{2Y} = \mu_{4Y} / \mathbb{V}(Y)^2 - 3}
}

\strong{5. Log-Likelihood and Gradient:}
The log-likelihood separates completely because \eqn{y=0} and \eqn{y>0} are disjoint events:
\deqn{\ell = \mathbb{I}(y=0)\log(p) + \mathbb{I}(y>0)[\log(1-p) + \log f_W(y; \theta)]}

The parameters \eqn{p} and \eqn{\theta} are orthogonal.
\itemize{
\item \eqn{\nabla_p \ell = \frac{1}{p}} if \eqn{y=0}, \eqn{\frac{-1}{1-p}} if \eqn{y>0}.
\item \eqn{\nabla_\theta \ell = 0} if \eqn{y=0}, \eqn{\nabla_\theta \log f_W(y)} if \eqn{y>0}.
}

\strong{6. Hessian Matrix:}
\itemize{
\item \strong{Block \eqn{pp}}: \eqn{-1/p^2} (if \eqn{y=0}) or \eqn{-1/(1-p)^2} (if \eqn{y>0}).
\item \strong{Block \eqn{p\theta}}: Always 0.
\item \strong{Block \eqn{\theta\theta}}: 0 (if \eqn{y=0}) or \eqn{H_W(y)} (if \eqn{y>0}).
}

\strong{7. Expected Hessian:}
\itemize{
\item \strong{Block \eqn{pp}}: \eqn{\mathbb{E}[-\partial^2 \ell] = \frac{1}{p(1-p)}}.
\item \strong{Block \eqn{\theta\theta}}: \eqn{(1-p) \mathbb{E}[H_W]} (Fisher information of \eqn{W} scaled by probability of non-zero).
}
}
